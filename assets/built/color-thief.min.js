var CanvasImage=function(t){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),document.body.appendChild(this.canvas),this.width=this.canvas.width=t.width,this.height=this.canvas.height=t.height,this.context.drawImage(t,0,0,this.width,this.height)};CanvasImage.prototype.clear=function(){this.context.clearRect(0,0,this.width,this.height)},CanvasImage.prototype.update=function(t){this.context.putImageData(t,0,0)},CanvasImage.prototype.getPixelCount=function(){return this.width*this.height},CanvasImage.prototype.getImageData=function(){return this.context.getImageData(0,0,this.width,this.height)},CanvasImage.prototype.removeCanvas=function(){this.canvas.parentNode.removeChild(this.canvas)};var ColorThief=function(){};if(ColorThief.prototype.getColor=function(t,r){return this.getPalette(t,5,r)[0]},ColorThief.prototype.getPalette=function(t,r,n){void 0===r&&(r=10),(void 0===n||n<1)&&(n=10);for(var o,e,a,i,u=new CanvasImage(t),c=u.getImageData().data,s=u.getPixelCount(),f=[],v=0;v<s;v+=n)e=c[(o=4*v)+0],a=c[o+1],i=c[o+2],125<=c[o+3]&&(250<e&&250<a&&250<i||f.push([e,a,i]));var h=MMCQ.quantize(f,r),p=h?h.palette():null;return u.removeCanvas(),p},!pv)var pv={map:function(t,n){var o={};return n?t.map(function(t,r){return o.index=r,n.call(o,t)}):t.slice()},naturalOrder:function(t,r){return t<r?-1:r<t?1:0},sum:function(t,o){var e={};return t.reduce(o?function(t,r,n){return e.index=n,t+o.call(e,r)}:function(t,r){return t+r},0)},max:function(t,r){return Math.max.apply(null,r?pv.map(t,r):t)}};var MMCQ=function(){function _(t,r,n){return(t<<2*O)+(r<<O)+n}function M(t){function r(){n.sort(t),o=!0}var n=[],o=!1;return{push:function(t){n.push(t),o=!1},peek:function(t){return o||r(),void 0===t&&(t=n.length-1),n[t]},pop:function(){return o||r(),n.pop()},size:function(){return n.length},map:function(t){return n.map(t)},debug:function(){return o||r(),n}}}function z(t,r,n,o,e,a,i){var u=this;u.r1=t,u.r2=r,u.g1=n,u.g2=o,u.b1=e,u.b2=a,u.histo=i}function k(){this.vboxes=new M(function(t,r){return pv.naturalOrder(t.vbox.count()*t.vbox.volume(),r.vbox.count()*r.vbox.volume())})}function E(t,s){if(s.count()){var r=s.r2-s.r1+1,n=s.g2-s.g1+1,o=s.b2-s.b1+1,e=pv.max([r,n,o]);if(1==s.count())return[s.copy()];var f,a,i,u,v=0,h=[],p=[];if(e==r)for(f=s.r1;f<=s.r2;f++){for(u=0,a=s.g1;a<=s.g2;a++)for(i=s.b1;i<=s.b2;i++)u+=t[_(f,a,i)]||0;v+=u,h[f]=v}else if(e==n)for(f=s.g1;f<=s.g2;f++){for(u=0,a=s.r1;a<=s.r2;a++)for(i=s.b1;i<=s.b2;i++)u+=t[_(a,f,i)]||0;v+=u,h[f]=v}else for(f=s.b1;f<=s.b2;f++){for(u=0,a=s.r1;a<=s.r2;a++)for(i=s.g1;i<=s.g2;i++)u+=t[_(a,i,f)]||0;v+=u,h[f]=v}return h.forEach(function(t,r){p[r]=v-t}),function(t){var r,n,o,e,a,i=t+"1",u=t+"2",c=0;for(f=s[i];f<=s[u];f++)if(h[f]>v/2){for(o=s.copy(),e=s.copy(),a=(r=f-s[i])<=(n=s[u]-f)?Math.min(s[u]-1,~~(f+n/2)):Math.max(s[i],~~(f-1-r/2));!h[a];)a++;for(c=p[a];!c&&h[a-1];)c=p[--a];return o[u]=a,e[i]=o[u]+1,[o,e]}}(e==r?"r":e==n?"g":"b")}}var O=5,D=8-O;return z.prototype={volume:function(t){var r=this;return r._volume&&!t||(r._volume=(r.r2-r.r1+1)*(r.g2-r.g1+1)*(r.b2-r.b1+1)),r._volume},count:function(t){var r=this,n=r.histo;if(!r._count_set||t){var o,e,a,i=0;for(o=r.r1;o<=r.r2;o++)for(e=r.g1;e<=r.g2;e++)for(a=r.b1;a<=r.b2;a++)index=_(o,e,a),i+=n[index]||0;r._count=i,r._count_set=!0}return r._count},copy:function(){var t=this;return new z(t.r1,t.r2,t.g1,t.g2,t.b1,t.b2,t.histo)},avg:function(t){var r=this,n=r.histo;if(!r._avg||t){var o,e,a,i,u=0,c=1<<8-O,s=0,f=0,v=0;for(e=r.r1;e<=r.r2;e++)for(a=r.g1;a<=r.g2;a++)for(i=r.b1;i<=r.b2;i++)u+=o=n[_(e,a,i)]||0,s+=o*(e+.5)*c,f+=o*(a+.5)*c,v+=o*(i+.5)*c;r._avg=u?[~~(s/u),~~(f/u),~~(v/u)]:[~~(c*(r.r1+r.r2+1)/2),~~(c*(r.g1+r.g2+1)/2),~~(c*(r.b1+r.b2+1)/2)]}return r._avg},contains:function(t){var r=this,n=t[0]>>D;return gval=t[1]>>D,bval=t[2]>>D,n>=r.r1&&n<=r.r2&&gval>=r.g1&&gval<=r.g2&&bval>=r.b1&&bval<=r.b2}},k.prototype={push:function(t){this.vboxes.push({vbox:t,color:t.avg()})},palette:function(){return this.vboxes.map(function(t){return t.color})},size:function(){return this.vboxes.size()},map:function(t){for(var r=this.vboxes,n=0;n<r.size();n++)if(r.peek(n).vbox.contains(t))return r.peek(n).color;return this.nearest(t)},nearest:function(t){for(var r,n,o,e=this.vboxes,a=0;a<e.size();a++)((n=Math.sqrt(Math.pow(t[0]-e.peek(a).color[0],2)+Math.pow(t[1]-e.peek(a).color[1],2)+Math.pow(t[2]-e.peek(a).color[2],2)))<r||void 0===r)&&(r=n,o=e.peek(a).color);return o},forcebw:function(){var t=this.vboxes;t.sort(function(t,r){return pv.naturalOrder(pv.sum(t.color),pv.sum(r.color))});var r=t[0].color;r[0]<5&&r[1]<5&&r[2]<5&&(t[0].color=[0,0,0]);var n=t.length-1,o=t[n].color;251<o[0]&&251<o[1]&&251<o[2]&&(t[n].color=[255,255,255])}},{quantize:function(t,r){function n(t,r){for(var n,o=1,e=0;e<1e3;)if((n=t.pop()).count()){var a=E(s,n),i=a[0],u=a[1];if(!i)return;if(t.push(i),u&&(t.push(u),o++),r<=o)return;if(1e3<e++)return}else t.push(n),e++}if(!t.length||r<2||256<r)return!1;var o,e,a,i,u,c,s=(o=t,c=new Array(1<<3*O),o.forEach(function(t){a=t[0]>>D,i=t[1]>>D,u=t[2]>>D,e=_(a,i,u),c[e]=(c[e]||0)+1}),c);s.forEach(function(){});var f,v,h,p,g,l,b,m,d,x,w=(f=s,d=b=g=1e6,x=m=l=0,t.forEach(function(t){v=t[0]>>D,h=t[1]>>D,p=t[2]>>D,v<g?g=v:l<v&&(l=v),h<b?b=h:m<h&&(m=h),p<d?d=p:x<p&&(x=p)}),new z(g,l,b,m,d,x,f)),C=new M(function(t,r){return pv.naturalOrder(t.count(),r.count())});C.push(w),n(C,.75*r);for(var y=new M(function(t,r){return pv.naturalOrder(t.count()*t.volume(),r.count()*r.volume())});C.size();)y.push(C.pop());n(y,r-y.size());for(var I=new k;y.size();)I.push(y.pop());return I}}}();
//# sourceMappingURL=color-thief.min.js.map
